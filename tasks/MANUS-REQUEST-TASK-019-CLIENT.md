# MANUS-REQUEST: TASK-019-CLIENT WebSocketé€šä¿¡ã®å¼·åŒ–ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ï¼‰

**Requested By**: Manus  
**Timestamp**: 2025-01-01  
**Priority**: High  
**Track**: mobile-app

---

## æŒ‡ç¤º

TASK-019-CLIENTï¼ˆWebSocketé€šä¿¡ã®å¼·åŒ– - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ï¼‰ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ï¼ˆTASK-019ï¼‰ã¯æ—¢ã«å®Œäº†ã—ã¦ãŠã‚Šã€ä»¥ä¸‹ã®æ–°ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºè¡Œã•ã‚Œã¦ã„ã¾ã™ï¼š
- `task_update` - å€‹åˆ¥ã‚¿ã‚¹ã‚¯ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´æ™‚
- `blocker_alert` - æ–°ã—ã„ãƒ–ãƒ­ãƒƒã‚«ãƒ¼æ¤œå‡ºæ™‚

## å‰ææ¡ä»¶

- âœ… TASK-012: ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªçŠ¶æ…‹ç®¡ç†ã®åˆ·æ–° - å®Œäº†
- âœ… TASK-019: WebSocketé€šä¿¡ã®å¼·åŒ–ï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ï¼‰ - å®Œäº†

## å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

1. **ã‚¿ã‚¹ã‚¯ä»•æ§˜æ›¸**: `tasks/TASK-019-CLIENT-WEBSOCKET-CLIENT.md`
2. **APIè¨­è¨ˆæ›¸**: `docs/design/API_SPECIFICATION.md`
3. **ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆæ›¸**: `docs/design/DATA_MODEL.md`
4. **ã‚µãƒ¼ãƒãƒ¼å®Ÿè£…å‚ç…§**: `src/server/src/index.ts`ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œéƒ¨åˆ†ï¼‰

## å®Ÿè£…æ‰‹é †

### 1. ãƒ–ãƒ©ãƒ³ãƒä½œæˆ

```bash
git checkout develop
git pull origin develop
git checkout -b feature/mobile-app/task-019-client-websocket
```

### 2. `dashboardStore.ts` ã®æ›´æ–°

ä»¥ä¸‹ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ï¼š

```typescript
// å‹ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’è¿½åŠ 
import { Task, Blocker, ProjectStatus, ConnectionStatus } from '@common/types';

// ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
updateTask: (task: Task) => void;
addBlocker: (blocker: Blocker) => void;
resolveBlocker: (blockerId: string) => void;
```

**å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ**:
- ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªæ›´æ–°ã‚’è¡Œã†ï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ¼”ç®—å­ã‚’ä½¿ç”¨ï¼‰
- `completedTasks`ã‚’å†è¨ˆç®—ã™ã‚‹
- `lastUpdated`ã‚’æ›´æ–°ã™ã‚‹
- é‡è¤‡ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã†ï¼ˆ`addBlocker`ï¼‰

### 3. `useWebSocket.ts` ã®æ›´æ–°

ä»¥ä¸‹ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ï¼š

```typescript
// task_update ã‚¤ãƒ™ãƒ³ãƒˆ
newSocket.on('task_update', (payload: { type: string; data: Task; timestamp: string }) => {
  console.log('Received task_update:', payload);
  updateTask(payload.data);
  addLog({
    id: `log-${Date.now()}`,
    timestamp: payload.timestamp,
    message: `ã‚¿ã‚¹ã‚¯æ›´æ–°: ${payload.data.id} â†’ ${payload.data.status}`,
    level: 'info',
    source: 'websocket',
  });
});

// blocker_alert ã‚¤ãƒ™ãƒ³ãƒˆ
newSocket.on('blocker_alert', (payload: { type: string; data: Blocker; timestamp: string }) => {
  console.log('Received blocker_alert:', payload);
  addBlocker(payload.data);
  addLog({
    id: `log-${Date.now()}`,
    timestamp: payload.timestamp,
    message: `âš ï¸ æ–°ã—ã„ãƒ–ãƒ­ãƒƒã‚«ãƒ¼: ${payload.data.title}`,
    level: 'warning',
    source: 'websocket',
  });
});
```

### 4. å‹ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆç¢ºèª

`useWebSocket.ts`ã§ä»¥ä¸‹ã®å‹ãŒã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

```typescript
import { Task, Blocker } from '@common/types';
```

### 5. æ¤œè¨¼

1. ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•: `cd src/server && npm start`
2. ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚’èµ·å‹•: `cd src/mobile && npm start`
3. `progress.md`ã®å˜ä¸€ã‚¿ã‚¹ã‚¯ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å¤‰æ›´
4. ã‚¢ãƒ—ãƒªãŒãã®ã‚¿ã‚¹ã‚¯ã®ã¿ã‚’æ›´æ–°ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
5. `progress.md`ã«æ–°ã—ã„ãƒ–ãƒ­ãƒƒã‚«ãƒ¼ã‚’è¿½åŠ 
6. ã‚¢ãƒ—ãƒªãŒãƒ–ãƒ­ãƒƒã‚«ãƒ¼ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’ç¢ºèª
7. ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°ã«æ–°ã—ã„ã‚¨ãƒ³ãƒˆãƒªãŒè¿½åŠ ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### 6. progress.md ã®æ›´æ–°

ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã€`progress.md` ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›´æ–°ã—ã¦ãã ã•ã„ï¼š

```markdown
| TASK-019-CLIENT | mobile-app | WebSocketé€šä¿¡ã®å¼·åŒ–ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ | âœ… Done | TASK-012, TASK-019 |
```

ã¾ãŸã€"Completed Task Details" ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å®Œäº†ã‚¨ãƒ³ãƒˆãƒªã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

### 7. PR ä½œæˆ

```bash
git add .
git commit -m "feat: Implement client-side WebSocket enhancement (TASK-019-CLIENT)"
git push origin feature/mobile-app/task-019-client-websocket
gh pr create --base main --title "feat: WebSocket client-side enhancement (TASK-019-CLIENT)" --body "..."
```

## å®Œäº†æ¡ä»¶ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] `dashboardStore.ts`ã«`updateTask`ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- [ ] `dashboardStore.ts`ã«`addBlocker`ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- [ ] `dashboardStore.ts`ã«`resolveBlocker`ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- [ ] `useWebSocket.ts`ã«`task_update`ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- [ ] `useWebSocket.ts`ã«`blocker_alert`ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- [ ] UIãŒéƒ¨åˆ†çš„ã«æ›´æ–°ã•ã‚Œã‚‹ï¼ˆå…¨ä½“ãƒªãƒ­ãƒ¼ãƒ‰ã§ã¯ãªã„ï¼‰
- [ ] ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°ã«ã‚¤ãƒ™ãƒ³ãƒˆãŒè¨˜éŒ²ã•ã‚Œã‚‹
- [ ] TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒãªã„
- [ ] æ—¢å­˜ã®`project_status`ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå¼•ãç¶šãå‹•ä½œã™ã‚‹
- [ ] progress.mdãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- [ ] PRãŒä½œæˆã•ã‚Œã¦ã„ã‚‹

---

ğŸ¤– Generated by Manus
